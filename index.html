<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Football Squares - Classic Design</title>
    <style>
        :root {
            --primary: #2e7d32; /* Grass Green */
            --secondary: #1b5e20; /* Dark Green */
            --highlight: #ff9800; /* Orange for active selection */
            --winner-border: #ffd700; /* Gold */
            --bg-color: #f4f4f9;
            --text-color: #333;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* --- LAYOUT --- */
        .app-container {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        .sidebar {
            width: 250px;
            background: white;
            border-right: 1px solid #ddd;
            display: flex;
            flex-direction: column;
            padding: 20px;
            box-shadow: 2px 0 5px rgba(0,0,0,0.05);
            z-index: 10;
        }

        .main-content {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* --- PLAYER LIST --- */
        .sidebar h2 { margin-top: 0; font-size: 1.2rem; color: var(--secondary); }
        
        .player-list {
            flex: 1;
            overflow-y: auto;
            margin-top: 10px;
        }

        .player-item {
            padding: 10px;
            margin-bottom: 8px;
            background: #f0f0f0;
            border-radius: 6px;
            cursor: pointer;
            border: 2px solid transparent;
            transition: all 0.2s;
        }

        .player-item:hover { background: #e0e0e0; }
        .player-item.active {
            background: #e8f5e9;
            border-color: var(--primary);
            color: var(--secondary);
            font-weight: bold;
        }

        .player-count {
            float: right;
            background: #ccc;
            color: white;
            border-radius: 10px;
            padding: 2px 6px;
            font-size: 0.8em;
        }
        .player-item.active .player-count { background: var(--primary); }

        /* --- BUTTONS --- */
        .btn {
            padding: 10px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            font-size: 0.9rem;
            width: 100%;
            margin-bottom: 10px;
            transition: background 0.2s;
        }
        .btn-primary { background: var(--primary); color: white; }
        .btn-primary:hover { background: var(--secondary); }
        .btn-action { width: auto; padding: 5px 10px; font-size: 0.8rem; margin: 2px; }
        .btn-danger { background: #d32f2f; color: white; }

        /* --- MODAL --- */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5);
            display: flex; justify-content: center; align-items: center;
            z-index: 1000;
        }
        .modal-box {
            background: white; padding: 25px; border-radius: 8px;
            width: 300px; box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            text-align: center;
        }
        .modal-box input {
            width: 100%; padding: 8px; margin: 8px 0;
            box-sizing: border-box; border: 1px solid #ccc; border-radius: 4px;
        }

        /* --- GRID --- */
        .grid-wrapper {
            display: inline-grid;
            /* 40px headers + 10 columns */
            grid-template-columns: 50px repeat(10, 50px);
            grid-template-rows: 50px repeat(10, 50px);
            gap: 2px;
            background: #333;
            border: 4px solid #333;
            margin-top: 20px;
        }

        .cell {
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            cursor: pointer;
            user-select: none;
            position: relative;
            font-size: 0.9rem;
        }

        .cell.header {
            background: var(--secondary);
            color: white;
            cursor: default;
        }
        
        .cell.taken {
            background: #e8f5e9; /* Light green */
            color: var(--secondary);
        }

        /* The specific winning border */
        .cell.winner {
            z-index: 10;
            border: 4px solid var(--winner-border) !important;
            background-color: #fff9c4 !important; /* Light yellow bg */
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
        }

        .team-logo { width: 30px; height: 30px; object-fit: contain; }

        /* --- GAME DASHBOARD --- */
        .scoreboard {
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            display: flex;
            gap: 40px;
            align-items: center;
            margin-bottom: 20px;
        }
        .team-score-block { text-align: center; }
        .big-score { font-size: 2.5rem; font-weight: bold; color: var(--primary); }
        .score-controls { display: grid; grid-template-columns: 1fr 1fr; gap: 5px; margin-top: 5px; }

        .hidden { display: none !important; }
    </style>
</head>
<body>

    <div id="modal" class="modal-overlay hidden">
        <div class="modal-box">
            <h3>Add Player</h3>
            <input type="text" id="p-name" placeholder="Full Name">
            <input type="text" id="p-init" placeholder="Initials (e.g. JD)" maxlength="3">
            <div style="margin-top: 15px;">
                <button class="btn btn-action" onclick="closeModal()">Cancel</button>
                <button class="btn btn-action btn-primary" onclick="confirmAddPlayer()">Add</button>
            </div>
        </div>
    </div>

    <div class="app-container">
        
        <div class="sidebar">
            <h2>Players</h2>
            <button class="btn btn-primary" onclick="openModal()">+ Add Player</button>
            <div id="player-list-container" class="player-list">
                <div style="color:#888; text-align:center; font-style:italic; margin-top:20px;">No players yet</div>
            </div>

            <hr style="width:100%; border:0; border-top:1px solid #ddd; margin: 20px 0;">
            
            <div id="setup-controls">
                <label style="font-weight:bold; display:block; margin-bottom:5px;">Top Team</label>
                <select id="team-top" style="width:100%; padding:5px; margin-bottom:15px;"></select>
                
                <label style="font-weight:bold; display:block; margin-bottom:5px;">Left Team</label>
                <select id="team-left" style="width:100%; padding:5px; margin-bottom:15px;"></select>
                
                <p id="total-squares" style="text-align:center; font-weight:bold; color:var(--secondary);">0 / 100 Filled</p>
                <button class="btn btn-primary" onclick="startGame()">Start Game</button>
            </div>

            <div id="game-controls" class="hidden">
                <button class="btn btn-primary" onclick="endQuarter()">End Quarter</button>
                <div id="quarter-log" style="margin-top:20px; font-size:0.85rem; height: 150px; overflow-y:auto; border-top:1px solid #eee; padding-top:10px;">
                    <strong>Quarter Log:</strong>
                    <ul id="log-list" style="padding-left:20px; margin:5px 0;"></ul>
                </div>
            </div>
        </div>

        <div class="main-content">
            
            <div id="setup-header">
                <h1>üèà Setup Board</h1>
                <p>Select a player on the left, then click squares to assign.</p>
            </div>

            <div id="game-scoreboard" class="scoreboard hidden">
                <div class="team-score-block">
                    <img id="sb-logo-1" class="team-logo" style="width:50px; height:50px;">
                    <h3 id="sb-name-1">Team 1</h3>
                    <div id="score-1" class="big-score">0</div>
                    <div class="score-controls">
                        <button class="btn btn-action" onclick="updateScore(1, 6)">+6</button>
                        <button class="btn btn-action" onclick="updateScore(1, 1)">+1</button>
                        <button class="btn btn-action" onclick="updateScore(1, 3)">+3</button>
                        <button class="btn btn-action btn-danger" onclick="updateScore(1, -1)">-1</button>
                    </div>
                </div>
                <div style="font-size: 1.5rem; font-weight:bold; color:#ccc;">VS</div>
                <div class="team-score-block">
                    <img id="sb-logo-2" class="team-logo" style="width:50px; height:50px;">
                    <h3 id="sb-name-2">Team 2</h3>
                    <div id="score-2" class="big-score">0</div>
                    <div class="score-controls">
                        <button class="btn btn-action" onclick="updateScore(2, 6)">+6</button>
                        <button class="btn btn-action" onclick="updateScore(2, 1)">+1</button>
                        <button class="btn btn-action" onclick="updateScore(2, 3)">+3</button>
                        <button class="btn btn-action btn-danger" onclick="updateScore(2, -1)">-1</button>
                    </div>
                </div>
            </div>

            <div id="grid-container" class="grid-wrapper">
                </div>

        </div>
    </div>

<script>
    // --- DATA ---
    const NFL_TEAMS = [
        { abbr: 'ARI', name: 'Cardinals' }, { abbr: 'ATL', name: 'Falcons' },
        { abbr: 'BAL', name: 'Ravens' }, { abbr: 'BUF', name: 'Bills' },
        { abbr: 'CAR', name: 'Panthers' }, { abbr: 'CHI', name: 'Bears' },
        { abbr: 'CIN', name: 'Bengals' }, { abbr: 'CLE', name: 'Browns' },
        { abbr: 'DAL', name: 'Cowboys' }, { abbr: 'DEN', name: 'Broncos' },
        { abbr: 'DET', name: 'Lions' }, { abbr: 'GB', name: 'Packers' },
        { abbr: 'HOU', name: 'Texans' }, { abbr: 'IND', name: 'Colts' },
        { abbr: 'JAX', name: 'Jaguars' }, { abbr: 'KC', name: 'Chiefs' },
        { abbr: 'LV', name: 'Raiders' }, { abbr: 'LAC', name: 'Chargers' },
        { abbr: 'LAR', name: 'Rams' }, { abbr: 'MIA', name: 'Dolphins' },
        { abbr: 'MIN', name: 'Vikings' }, { abbr: 'NE', name: 'Patriots' },
        { abbr: 'NO', name: 'Saints' }, { abbr: 'NYG', name: 'Giants' },
        { abbr: 'NYJ', name: 'Jets' }, { abbr: 'PHI', name: 'Eagles' },
        { abbr: 'PIT', name: 'Steelers' }, { abbr: 'SF', name: '49ers' },
        { abbr: 'SEA', name: 'Seahawks' }, { abbr: 'TB', name: 'Buccaneers' },
        { abbr: 'TEN', name: 'Titans' }, { abbr: 'WAS', name: 'Commanders' }
    ];

    let players = [];
    let activePlayerId = null;
    let gridData = Array(100).fill(null);
    let topNums = Array(10).fill('?');
    let leftNums = Array(10).fill('?');
    let teamTop = null;
    let teamLeft = null;
    let score1 = 0; // Top Team
    let score2 = 0; // Left Team
    let gameActive = false;
    let quarter = 1;

    // --- INIT ---
    window.onload = () => {
        const t1 = document.getElementById('team-top');
        const t2 = document.getElementById('team-left');
        NFL_TEAMS.forEach(t => {
            const opt = `<option value="${t.abbr}">${t.name}</option>`;
            t1.innerHTML += opt;
            t2.innerHTML += opt;
        });
        t2.selectedIndex = 1;
        renderGrid();
    };

    // --- PLAYER MANAGEMENT ---
    function openModal() { document.getElementById('modal').classList.remove('hidden'); }
    function closeModal() { 
        document.getElementById('modal').classList.add('hidden'); 
        document.getElementById('p-name').value = '';
        document.getElementById('p-init').value = '';
    }

    function confirmAddPlayer() {
        const name = document.getElementById('p-name').value.trim();
        const init = document.getElementById('p-init').value.trim().toUpperCase();
        
        if(!name || !init) return alert("Please enter Name and Initials");
        
        const newPlayer = {
            id: Date.now(),
            name: name,
            initials: init,
            count: 0
        };
        
        players.push(newPlayer);
        activePlayerId = newPlayer.id; // Auto select new player
        closeModal();
        renderPlayerList();
    }

    function renderPlayerList() {
        const container = document.getElementById('player-list-container');
        if(players.length === 0) {
            container.innerHTML = '<div style="color:#888; text-align:center; margin-top:20px;">No players yet</div>';
            return;
        }
        
        container.innerHTML = '';
        players.forEach(p => {
            const div = document.createElement('div');
            div.className = `player-item ${activePlayerId === p.id ? 'active' : ''}`;
            div.innerHTML = `
                <span>${p.initials} - ${p.name}</span>
                <span class="player-count">${p.count}</span>
            `;
            div.onclick = () => {
                activePlayerId = p.id;
                renderPlayerList();
            };
            container.appendChild(div);
        });
    }

    // --- GRID LOGIC ---
    function renderGrid() {
        const grid = document.getElementById('grid-container');
        grid.innerHTML = '';

        // Corner Cell
        grid.innerHTML += `<div class="cell header" style="background:#222; font-size:0.8rem;">Q${gameActive ? quarter : '?'}</div>`;

        // Top Header
        topNums.forEach((n, i) => {
            const div = document.createElement('div');
            div.className = 'cell header';
            div.innerText = n;
            div.id = `th-${i}`;
            // Optional: Add team logo if game started
            if(gameActive) div.style.borderTop = "4px solid var(--secondary)";
            grid.appendChild(div);
        });

        // Rows
        for(let r=0; r<10; r++) {
            // Left Header
            const lh = document.createElement('div');
            lh.className = 'cell header';
            lh.innerText = leftNums[r];
            lh.id = `lh-${r}`;
            if(gameActive) lh.style.borderLeft = "4px solid var(--secondary)";
            grid.appendChild(lh);

            // Cells
            for(let c=0; c<10; c++) {
                const idx = r * 10 + c;
                const owner = gridData[idx];
                const div = document.createElement('div');
                div.className = `cell ${owner ? 'taken' : ''}`;
                div.id = `cell-${r}-${c}`;
                div.innerText = owner ? owner.initials : '';
                
                if(!gameActive) {
                    div.onclick = () => handleSquareClick(idx);
                }
                
                grid.appendChild(div);
            }
        }
        
        updateTotalCount();
    }

    function handleSquareClick(idx) {
        if(!activePlayerId) return alert("Please select a player from the list first.");
        
        const currentPlayer = players.find(p => p.id === activePlayerId);
        
        // Toggle logic
        if(gridData[idx] && gridData[idx].id === activePlayerId) {
            // Remove
            gridData[idx] = null;
            currentPlayer.count--;
        } else if (gridData[idx]) {
            // Taken by someone else
            alert("Square taken!");
            return;
        } else {
            // Take
            gridData[idx] = currentPlayer;
            currentPlayer.count++;
        }
        
        renderGrid(); // Re-render grid to show change
        renderPlayerList(); // Update counts
    }

    function updateTotalCount() {
        const total = gridData.filter(x => x).length;
        document.getElementById('total-squares').innerText = `${total} / 100 Filled`;
    }

    // --- GAME LOGIC ---
    function startGame() {
        const filled = gridData.filter(x => x).length;
        if(filled < 100 && !confirm("Grid not full. Start anyway?")) return;

        // Set Teams
        const t1Val = document.getElementById('team-top').value;
        const t2Val = document.getElementById('team-left').value;
        teamTop = NFL_TEAMS.find(t => t.abbr === t1Val);
        teamLeft = NFL_TEAMS.find(t => t.abbr === t2Val);

        // Randomize Numbers
        topNums = [0,1,2,3,4,5,6,7,8,9].sort(() => Math.random() - 0.5);
        leftNums = [0,1,2,3,4,5,6,7,8,9].sort(() => Math.random() - 0.5);

        gameActive = true;

        // UI Updates
        document.getElementById('setup-controls').classList.add('hidden');
        document.getElementById('game-controls').classList.remove('hidden');
        document.getElementById('setup-header').classList.add('hidden');
        document.getElementById('game-scoreboard').classList.remove('hidden');

        // Populate Scoreboard
        document.getElementById('sb-name-1').innerText = teamTop.name;
        document.getElementById('sb-logo-1').src = `https://a.espncdn.com/i/teamlogos/nfl/500/${teamTop.abbr}.png`;
        
        document.getElementById('sb-name-2').innerText = teamLeft.name;
        document.getElementById('sb-logo-2').src = `https://a.espncdn.com/i/teamlogos/nfl/500/${teamLeft.abbr}.png`;

        renderGrid();
        checkWinner(); // Run once to highlight 0-0
    }

    function updateScore(team, amount) {
        if(team === 1) score1 = Math.max(0, score1 + amount);
        else score2 = Math.max(0, score2 + amount);

        document.getElementById('score-1').innerText = score1;
        document.getElementById('score-2').innerText = score2;

        checkWinner();
    }

    function checkWinner() {
        // Remove old highlights
        document.querySelectorAll('.winner').forEach(el => el.classList.remove('winner'));
        document.querySelectorAll('.header').forEach(el => el.style.background = 'var(--secondary)');
        document.querySelectorAll('.header').forEach(el => el.style.color = 'white');

        // Calc indices
        const topDigit = score1 % 10;
        const leftDigit = score2 % 10;
        
        const colIdx = topNums.indexOf(topDigit);
        const rowIdx = leftNums.indexOf(leftDigit);

        // Highlight Headers
        const th = document.getElementById(`th-${colIdx}`);
        const lh = document.getElementById(`lh-${rowIdx}`);
        
        th.style.background = 'var(--winner-border)';
        th.style.color = 'black';
        
        lh.style.background = 'var(--winner-border)';
        lh.style.color = 'black';

        // Highlight Cell (Thick Border)
        const cell = document.getElementById(`cell-${rowIdx}-${colIdx}`);
        cell.classList.add('winner');
    }

    function endQuarter() {
        const topDigit = score1 % 10;
        const leftDigit = score2 % 10;
        const colIdx = topNums.indexOf(topDigit);
        const rowIdx = leftNums.indexOf(leftDigit);
        
        const winner = gridData[rowIdx * 10 + colIdx];
        const winnerName = winner ? `${winner.name} (${winner.initials})` : "Unclaimed";

        const log = document.getElementById('log-list');
        const li = document.createElement('li');
        li.innerHTML = `Q${quarter}: ${teamTop.abbr} ${score1} - ${teamLeft.abbr} ${score2} &rarr; <strong>${winnerName}</strong>`;
        log.appendChild(li);

        quarter++;
        renderGrid(); // update corner Q label
    }

</script>
</body>
</html>
