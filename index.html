<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Football Squares Pro</title>
    <style>
        :root {
            --bg-color: #f4f4f9;
            --text-color: #333;
            --border-color: #ccc;
            --cell-size: 65px; /* Bigger grid cells */
            --winner-border: #ffd700; /* Gold */
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            height: 100vh;
            display: flex;
            overflow: hidden;
        }

        /* --- SIDEBAR (Player List) --- */
        .sidebar {
            width: 300px;
            background: white;
            border-right: 1px solid #ddd;
            display: flex;
            flex-direction: column;
            padding: 20px;
            box-shadow: 2px 0 5px rgba(0,0,0,0.05);
            z-index: 10;
        }

        .player-list {
            flex: 1;
            overflow-y: auto;
            margin-top: 10px;
            border: 1px solid #eee;
            border-radius: 4px;
        }

        .player-item {
            padding: 12px;
            border-bottom: 1px solid #eee;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
        }
        .player-item:hover { background: #f9f9f9; }
        .player-item.active { background: #e3f2fd; font-weight: bold; }

        /* --- MAIN AREA --- */
        .main-content {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* --- SCOREBOARD --- */
        .scoreboard {
            background: white;
            width: 95%; /* Longer sideways */
            padding: 15px 30px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }
        
        .team-display {
            display: flex;
            align-items: center;
            gap: 15px;
            min-width: 300px;
        }
        
        .score-big {
            font-size: 3.5rem;
            font-weight: 800;
            font-family: monospace;
            line-height: 1;
        }

        .controls {
            display: flex;
            gap: 5px;
        }

        /* --- THE GRID LAYOUT --- */
        .grid-area {
            display: grid;
            grid-template-columns: 50px auto; /* Left Label | Grid */
            grid-template-rows: 50px auto;    /* Top Label  | Grid */
            gap: 5px;
        }

        /* Team Names on Grid */
        .grid-label-top {
            grid-column: 2;
            grid-row: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: bold;
            color: #555;
            text-transform: uppercase;
        }
        
        .grid-label-left {
            grid-column: 1;
            grid-row: 2;
            writing-mode: vertical-rl;
            transform: rotate(180deg);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: bold;
            color: #555;
            text-transform: uppercase;
        }

        /* The Actual Grid */
        .grid-container {
            grid-column: 2;
            grid-row: 2;
            display: grid;
            grid-template-columns: var(--cell-size) repeat(10, var(--cell-size));
            grid-template-rows: var(--cell-size) repeat(10, var(--cell-size));
            border: 2px solid #333;
        }

        .cell {
            background: white;
            border: 1px solid #ccc;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.1rem;
            cursor: pointer;
            user-select: none;
            color: black; /* Always black text */
            position: relative;
        }

        /* Header Cells (Numbers) */
        .cell.header {
            color: white;
            font-size: 1.3rem;
            border: 1px solid rgba(0,0,0,0.2);
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }

        /* Active Winning Box (Current Score) */
        .cell.current-winner {
            box-shadow: inset 0 0 0 4px var(--winner-border);
            background-color: rgba(255, 215, 0, 0.2); /* Light gold tint */
            z-index: 5;
        }

        /* Past Quarter Winners (Locked borders) */
        .cell.past-winner {
            box-shadow: inset 0 0 0 4px #d32f2f; /* Red border for finished quarters */
            z-index: 4;
        }
        
        /* Optional: Add a small badge to past winners */
        .cell.past-winner::after {
            content: '‚òÖ';
            position: absolute;
            top: 2px;
            right: 2px;
            font-size: 10px;
            color: #d32f2f;
        }

        /* --- UTILS --- */
        .btn { padding: 10px 20px; cursor: pointer; border: none; border-radius: 4px; font-weight: bold; }
        .btn-primary { background: #1976d2; color: white; }
        .btn-danger { background: #d32f2f; color: white; }
        .btn-sm { padding: 5px 10px; font-size: 0.8rem; }
        .hidden { display: none !important; }
        
        .modal { position: fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); display:flex; justify-content:center; align-items:center; z-index:100; }
        .modal-content { background:white; padding:30px; border-radius:8px; width:300px; text-align:center; }
        .modal-content input { width:90%; padding:10px; margin:10px 0; border:1px solid #ccc; }

    </style>
</head>
<body>

    <div id="modal" class="modal hidden">
        <div class="modal-content">
            <h3>Add Player</h3>
            <input type="text" id="new-name" placeholder="Name">
            <input type="text" id="new-init" placeholder="Initials (e.g. JD)" maxlength="3">
            <br><br>
            <button class="btn btn-primary" onclick="addPlayer()">Save</button>
            <button class="btn" onclick="closeModal()">Cancel</button>
        </div>
    </div>

    <div class="sidebar">
        <h2>üèà Squares App</h2>
        
        <div id="setup-controls">
            <button id="btn-add-player" class="btn btn-primary" style="width:100%" onclick="openModal()">+ Add Player</button>
            <p style="font-size:0.9rem; color:#666; margin-top:10px;">Select a player below, then click squares.</p>
        </div>

        <div id="player-list" class="player-list">
            </div>

        <div style="margin-top:20px; border-top:1px solid #ddd; padding-top:20px;">
            <div id="team-selects">
                <label><strong>Top Team:</strong></label>
                <select id="sel-top" style="width:100%; padding:8px; margin-bottom:10px;"></select>
                
                <label><strong>Left Team:</strong></label>
                <select id="sel-left" style="width:100%; padding:8px; margin-bottom:10px;"></select>
                
                <p id="square-count">0 / 100 Squares Filled</p>
                <button class="btn btn-primary" style="width:100%; font-size:1.1rem;" onclick="startGame()">START GAME</button>
            </div>

            <div id="game-controls" class="hidden">
                <button class="btn btn-danger" style="width:100%; margin-bottom:10px;" onclick="endQuarter()">End Quarter</button>
                <div style="font-size:0.85rem; height:150px; overflow-y:auto; background:#f5f5f5; padding:5px; border:1px solid #ccc;">
                    <strong>History:</strong>
                    <ul id="game-log" style="padding-left:20px; margin:5px 0;"></ul>
                </div>
            </div>
        </div>
    </div>

    <div class="main-content">
        
        <div id="scoreboard" class="scoreboard hidden">
            <div class="team-display">
                <div style="text-align:center;">
                    <h2 id="sb-name-top" style="margin:0;">Team 1</h2>
                    <div class="controls">
                        <button class="btn btn-sm btn-primary" onclick="score(1, 6)">+6</button>
                        <button class="btn btn-sm btn-primary" onclick="score(1, 1)">+1</button>
                        <button class="btn btn-sm btn-primary" onclick="score(1, 3)">+3</button>
                        <button class="btn btn-sm btn-danger" onclick="score(1, -1)">-1</button>
                    </div>
                </div>
                <div id="score-top" class="score-big" style="color:#1976d2">0</div>
            </div>

            <div style="font-size:2rem; color:#ccc;">VS</div>

            <div class="team-display" style="justify-content: flex-end;">
                <div id="score-left" class="score-big" style="color:#d32f2f">0</div>
                <div style="text-align:center;">
                    <h2 id="sb-name-left" style="margin:0;">Team 2</h2>
                    <div class="controls">
                        <button class="btn btn-sm btn-primary" onclick="score(2, 6)">+6</button>
                        <button class="btn btn-sm btn-primary" onclick="score(2, 1)">+1</button>
                        <button class="btn btn-sm btn-primary" onclick="score(2, 3)">+3</button>
                        <button class="btn btn-sm btn-danger" onclick="score(2, -1)">-1</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="grid-area">
            <div id="lbl-top" class="grid-label-top"></div>
            <div id="lbl-left" class="grid-label-left"></div>
            <div id="grid" class="grid-container">
                </div>
        </div>

    </div>

<script>
    // --- NFL DATA (Accurate Hex Colors) ---
    const TEAMS = [
        { name: "Arizona Cardinals", color: "#97233F" },
        { name: "Atlanta Falcons", color: "#A71930" },
        { name: "Baltimore Ravens", color: "#241773" },
        { name: "Buffalo Bills", color: "#00338D" },
        { name: "Carolina Panthers", color: "#0085CA" },
        { name: "Chicago Bears", color: "#0B162A" },
        { name: "Cincinnati Bengals", color: "#FB4F14" },
        { name: "Cleveland Browns", color: "#311D00" },
        { name: "Dallas Cowboys", color: "#003594" },
        { name: "Denver Broncos", color: "#FB4F14" },
        { name: "Detroit Lions", color: "#0076B6" },
        { name: "Green Bay Packers", color: "#203731" },
        { name: "Houston Texans", color: "#03202F" },
        { name: "Indianapolis Colts", color: "#002C5F" },
        { name: "Jacksonville Jaguars", color: "#006778" },
        { name: "Kansas City Chiefs", color: "#E31837" },
        { name: "Las Vegas Raiders", color: "#000000" },
        { name: "L.A. Chargers", color: "#0080C6" },
        { name: "L.A. Rams", color: "#003594" },
        { name: "Miami Dolphins", color: "#008E97" },
        { name: "Minnesota Vikings", color: "#4F2683" },
        { name: "New England Patriots", color: "#002244" },
        { name: "New Orleans Saints", color: "#D3BC8D" },
        { name: "New York Giants", color: "#0B2265" },
        { name: "New York Jets", color: "#125740" },
        { name: "Philadelphia Eagles", color: "#004C54" },
        { name: "Pittsburgh Steelers", color: "#FFB612" },
        { name: "San Francisco 49ers", color: "#AA0000" },
        { name: "Seattle Seahawks", color: "#002244" },
        { name: "Tampa Bay Buccaneers", color: "#D50A0A" },
        { name: "Tennessee Titans", color: "#0C2340" },
        { name: "Washington Commanders", color: "#5A1414" }
    ];

    // --- STATE ---
    let players = [];
    let activePlayerIdx = null;
    let gridOwners = Array(100).fill(null);
    let topNums = Array(10).fill('?');
    let leftNums = Array(10).fill('?');
    let gameStarted = false;
    let scoreT = 0, scoreL = 0;
    let teamT = null, teamL = null;
    let quarter = 1;
    let pastWinners = []; // Store indices of boxes that won quarters

    // --- INIT ---
    window.onload = () => {
        const sT = document.getElementById('sel-top');
        const sL = document.getElementById('sel-left');
        TEAMS.forEach((t, i) => {
            sT.add(new Option(t.name, i));
            sL.add(new Option(t.name, i));
        });
        sL.selectedIndex = 1; // Different default
        renderGrid();
    };

    // --- PLAYERS ---
    function openModal() { document.getElementById('modal').classList.remove('hidden'); }
    function closeModal() { document.getElementById('modal').classList.add('hidden'); }
    
    function addPlayer() {
        const name = document.getElementById('new-name').value.trim();
        const init = document.getElementById('new-init').value.trim().toUpperCase();
        if(!name || !init) return alert("Enter Name and Initials");
        
        players.push({ name, init, count: 0 });
        document.getElementById('new-name').value = '';
        document.getElementById('new-init').value = '';
        activePlayerIdx = players.length - 1;
        
        closeModal();
        renderPlayers();
    }

    function renderPlayers() {
        const list = document.getElementById('player-list');
        list.innerHTML = '';
        players.forEach((p, i) => {
            const div = document.createElement('div');
            div.className = `player-item ${i === activePlayerIdx ? 'active' : ''}`;
            div.innerHTML = `<span>${p.init} - ${p.name}</span> <span style="background:#ddd; padding:2px 6px; border-radius:10px; font-size:0.8rem;">${p.count}</span>`;
            if(!gameStarted) {
                div.onclick = () => { activePlayerIdx = i; renderPlayers(); };
            } else {
                div.style.cursor = 'default';
                div.style.opacity = '0.7';
            }
            list.appendChild(div);
        });
    }

    // --- GRID LOGIC ---
    function renderGrid() {
        const grid = document.getElementById('grid');
        grid.innerHTML = '';

        // 1. Corner (Top-Left)
        const corner = document.createElement('div');
        corner.className = 'cell header';
        corner.style.background = '#222';
        corner.textContent = gameStarted ? `Q${quarter}` : '';
        grid.appendChild(corner);

        // 2. Top Headers (Numbers)
        topNums.forEach(n => {
            const div = document.createElement('div');
            div.className = 'cell header';
            div.textContent = n;
            if(gameStarted) div.style.backgroundColor = teamT.color;
            else div.style.backgroundColor = '#666';
            grid.appendChild(div);
        });

        // 3. Rows
        for(let r=0; r<10; r++) {
            // Left Header
            const leftHead = document.createElement('div');
            leftHead.className = 'cell header';
            leftHead.textContent = leftNums[r];
            if(gameStarted) leftHead.style.backgroundColor = teamL.color;
            else leftHead.style.backgroundColor = '#666';
            grid.appendChild(leftHead);

            // Cells
            for(let c=0; c<10; c++) {
                const idx = r * 10 + c;
                const owner = gridOwners[idx];
                const div = document.createElement('div');
                div.className = 'cell';
                div.textContent = owner ? owner.init : '';
                div.id = `c-${r}-${c}`;
                
                // Past Winner Logic
                if(pastWinners.includes(idx)) {
                    div.classList.add('past-winner');
                }

                if(!gameStarted) {
                    div.onclick = () => toggleSquare(idx);
                }
                
                grid.appendChild(div);
            }
        }
        
        document.getElementById('square-count').textContent = `${gridOwners.filter(x=>x).length} / 100 Squares Filled`;
    }

    function toggleSquare(idx) {
        if(activePlayerIdx === null) return alert("Add and select a player first.");
        const p = players[activePlayerIdx];

        if(gridOwners[idx] === p) {
            gridOwners[idx] = null;
            p.count--;
        } else if(gridOwners[idx] === null) {
            gridOwners[idx] = p;
            p.count++;
        } else {
            alert("Square taken!");
            return;
        }
        renderGrid();
        renderPlayers();
    }

    // --- GAME LOGIC ---
    function startGame() {
        const filled = gridOwners.filter(x=>x).length;
        if(filled < 100 && !confirm("Grid isn't full. Start anyway?")) return;

        // Lock Data
        teamT = TEAMS[document.getElementById('sel-top').value];
        teamL = TEAMS[document.getElementById('sel-left').value];
        
        // Randomize
        topNums = [0,1,2,3,4,5,6,7,8,9].sort(()=>Math.random()-0.5);
        leftNums = [0,1,2,3,4,5,6,7,8,9].sort(()=>Math.random()-0.5);
        
        gameStarted = true;

        // UI Transition
        document.getElementById('setup-controls').classList.add('hidden');
        document.getElementById('team-selects').classList.add('hidden');
        document.getElementById('game-controls').classList.remove('hidden');
        document.getElementById('scoreboard').classList.remove('hidden');

        // Set Labels & Colors
        document.getElementById('lbl-top').textContent = teamT.name;
        document.getElementById('lbl-top').style.color = teamT.color;
        document.getElementById('sb-name-top').textContent = teamT.name;
        document.getElementById('score-top').style.color = teamT.color;

        document.getElementById('lbl-left').textContent = teamL.name;
        document.getElementById('lbl-left').style.color = teamL.color;
        document.getElementById('sb-name-left').textContent = teamL.name;
        document.getElementById('score-left').style.color = teamL.color;

        renderGrid();
        renderPlayers(); // Locks UI
        highlightWinner();
    }

    function score(team, val) {
        if(team===1) scoreT = Math.max(0, scoreT + val);
        else scoreL = Math.max(0, scoreL + val);

        document.getElementById('score-top').textContent = scoreT;
        document.getElementById('score-left').textContent = scoreL;
        highlightWinner();
    }

    function highlightWinner() {
        // Remove current winner highlight (keep past winners)
        document.querySelectorAll('.current-winner').forEach(e => e.classList.remove('current-winner'));

        const digitT = scoreT % 10;
        const digitL = scoreL % 10;

        const col = topNums.indexOf(digitT);
        const row = leftNums.indexOf(digitL);

        const cell = document.getElementById(`c-${row}-${col}`);
        if(cell) cell.classList.add('current-winner');
    }

    function endQuarter() {
        const digitT = scoreT % 10;
        const digitL = scoreL % 10;
        const col = topNums.indexOf(digitT);
        const row = leftNums.indexOf(digitL);
        const idx = row * 10 + col;

        // 1. Add to permanent winners
        pastWinners.push(idx);

        // 2. Log it
        const winner = gridOwners[idx];
        const log = document.getElementById('game-log');
        const li = document.createElement('li');
        li.innerHTML = `<strong>Q${quarter}:</strong> ${teamT.name} ${scoreT} - ${teamL.name} ${scoreL} <br> Winner: ${winner ? winner.init : 'Empty'}`;
        log.appendChild(li);

        // 3. Advance
        quarter++;
        renderGrid(); // Re-renders grid, applying .past-winner class
        highlightWinner(); // Re-apply current winner highlight on top
    }

</script>
</body>
</html>
